<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="571"/>

<div>
<span><div>1、nfs</div><div>开发板挂载nfs服务器共享目录</div><div>#mount -t nfs -o nolock,nfsvers=3,vers=3 192.168.1.67:/home/lzc/nfs /nfs/</div><div>  mount -t nfs -o nolock,nfsvers=3,vers=3 192.168.1.89:/home/develop/nfs_share /nfs/</div><div>卸载开发板的nfs挂载目录</div><div>#umount /nfs/</div><div><br/></div><div>2、tftp</div><div>下载tftp服务器工作目录中的文件</div><div>#tftp -g -r test 192.168.1.88</div><div>上传到tftp服务器工作目录</div><div>#tftp -p -r test 192.168.1.88</div><div><br/></div><div>3、AM5728 ti的SDK开发包下的触屏校准目前看不是tslib的方式，</div><div>使用weston-calibrator工具就行校准，和用weston方式显示相关</div><div>目前方法</div><div>rm /run/media/mmcblk0p1/ws-calibrate.rules</div><div>sync</div><div>rm /etc/udev/rules.d/ws-calibrate.rules</div><div>sync</div><div>reboot</div><div><br/></div><div>4、显示采用weston方式，修改QT界面在weston下显示到屏幕的顶部</div><div>修改</div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); color: rgb(68, 68, 68); font-family: &quot;microsoft yahei&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">“/etc/weston.ini”文件，将panel-location=top的参数修改为空</span></div><div><img src="index_files/Image.png" type="image/png" data-filename="Image.png" width="350"/></div><div><br/></div><div>保存 sync，reboot重启生效</div><div><br/></div><div>5、关闭ti自带的matrix界面</div><div>/etc/init.d/matrix-gui-2.0 stop</div><div><br/></div><div>6、从SD卡烧写程序到emmc中，执行脚本 ./mkemmc-boot.sh --device /dev/mmcblk1（<span style="color: rgb(255, 0, 0);">注意需要将脚本放在/opt/tools目录下，否则失败</span>），</div><div>输入“y”确认重新分区， 按 Enter 键开始固化系统，用时 5 min 后系统固化成功。</div><div>成功固化 Linux 系统到 eMMC 后，将开发板断电， 取出 SD 系统启动卡， 拨码开关拨为 00000（1~5） 档位</div><div><br/></div><div>7、从emmc启动后修改完文件断掉会有保存不上的情况，需要sync立即写入</div><div><br/></div><div>8、借助ti的sdk开发包中qt环境需要</div><div>source /ti-processor-sdk-linux-am57xx-evm-03.01.00.06/linux-devkit/environment-setup</div><div>./qtcreator</div><div><img src="index_files/Image_2.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div>9、IPC通信时查看DSP打印信息</div><div><br/></div><div>    代码中使用 <span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">Console_printf</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"> 进行打印调试</span></div><div>    #define Console_printf System_printf</div><div><br/></div><div>    用如下指令进行查看</div><div>    cat /sys/kernel/debug/remoteproc/remoteproc2/trace0</div><div><br/></div><div><br/></div><div>10、在Linux下连接DSP仿真器</div><div>echo &quot;on&quot; &gt; /sys/bus/platform/devices/40800000.dsp/power/control</div><div><br/></div><div><br/></div><div>11、释放opencl共享内存的占用 </div><div>pkill ti-mctd</div><div><br/></div><div><br/></div><div><br/></div><div>12、BOIS驱动外设，这里指向了pcie路径举例</div><div><a href="file:///home/lzc/am5728/rtos_sdk/pdk_am57xx_1_0_4/packages/ti/drv/pcie/example/sample">/home/lzc/am5728/rtos_sdk/pdk_am57xx_1_0_4/packages/ti/drv/pcie/example/sample</a></div><div><br/></div><div><br/></div><div>13、rtos_sdk环境变量的设置</div><div>export PATH=$PATH:/home/lzc/am5728/linux_sdk/linux-devkit/sysroots/x86_64-arago-linux/usr/bin</div><div>export SDK_INSTALL_PATH=/home/lzc/am5728/rtos_sdk</div><div>export PROC_SDK_INSTALL_PATH=/home/lzc/am5728/rtos_sdk/processor_sdk_rtos_am57xx_3_01_00_06</div><div>export TOOLS_INSTALL_PATH=/home/lzc/ti</div><div>source /home/lzc/am5728/rtos_sdk/processor_sdk_rtos_am57xx_3_01_00_06/setupenv.sh</div><div><br/></div><div>linux的SDK下 Rules.make中 添加</div><div>#Points to the root of the TI SDK</div><div>export TI_SDK_PATH=/home/lzc/am5728/linux_sdk</div><div>export TI_RTOS_PATH=/home/lzc/am5728/rtos_sdk</div><div><br/></div><div><br/></div><div>14、DSP作为pcie的RP端时候</div><div>默认情况下 Linux 内核启动后会初始化 PCIe 外设，当 DSP 核上运行的 RTOS 系统需要</div><div>再次对 PCIe 进行初始化时， 此时会出现不稳定的情况，因此关闭 ARM 端对 PCIe 的初始</div><div>化是比较好的选择。</div><div>修改 Linux 内核&quot;arch/arm/boot/dts/am57xx-beagle-x15-common.dtsi&quot;设备树源文件， 将&quot;pcie1_rc&quot;的 status 参数值修改为&quot;disable&quot;</div><div>没有就添加</div><div><span style="font-size: 12pt; font-family: Calibri;">&amp;pcie1_rc {</span></div><div><span style="font-size: 12pt; font-family: Calibri;">    status = &quot;disable&quot;;</span></div><div><span style="font-size: 12pt; font-family: Calibri;">};</span></div><div><span style="font-size: 12pt; font-family: Calibri;">&amp;pcie1_ep {</span></div><div><span style="font-size: 12pt; font-family: Calibri;">    status = &quot;disable&quot;;</span></div><div><span style="font-size: 12pt; font-family: Calibri;">};</span></div><div><img src="index_files/Image_3.png" type="image/png" data-filename="Image.png" width="585"/></div><div>修改完成后，重新编译生成对应平台的 dtb 文件，并将新生成的 dtb 文件替换掉开发</div><div>板 SD 启动卡文件系统 boot 分区下的同名文件。</div><div><br/></div><div>15、制作SD卡镜像</div><div>sudo fdisk -l</div><div><span style="font-weight: bold;">sudo ./mksdboot.sh --device /dev/sdb</span></div><div><br/></div><div><br/></div><div>16、制作补丁与打补丁</div><div><span style="font-size: 12pt; font-family: 新宋体;-en-paragraph:true;">#diff –ruN src_old src_new &gt; src.patch</span></div><div><span style="font-size: 12pt;-en-paragraph:true;"><br/></span></div><div><span style="font-size: 12pt; font-family: 新宋体;-en-paragraph:true;">#patch -p1 -d src &lt; src.patch</span></div><div><span style="font-size: 12pt;-en-paragraph:true;"><br/></span></div><div><span style="font-size: 12pt; font-family: 新宋体;-en-paragraph:true;">17、查看温度</span></div><div><span style="font-size: 12pt; font-family: 新宋体;">cat /sys/class/hwmon/hwmon1/temp1_input</span></div></span>
</div></body></html>\00
